import{a as t,j as r}from"./jsx-runtime-VmuvLVu_.js";import{r as s}from"./index-XiNr8FW2.js";import{N as te}from"./NoteTagBadge-CiaD47-G.js";import{S as A,N as ne,T as re,A as se}from"./notu-Zi0Mo9zw.js";import{N as le}from"./NoteAttrEditor-BAMDFnwu.js";import"./_commonjsHelpers-5-cIlDoe.js";const h=({note:a,spaces:c,tags:x,attrs:D,onConfirm:_})=>{var C;const[f,k]=s.useState(a.date.toISOString().split("T")[0]),[$,E]=s.useState(a.spaceId),[N,O]=s.useState(a.date.toTimeString().split(" ")[0].substring(0,5)),[q,V]=s.useState(((C=a.ownTag)==null?void 0:C.name)??""),[j,B]=s.useState(a.text),[P,F]=s.useState(a.archived),[v,T]=s.useState(a.tags.map(e=>e.tagId)),[u,I]=s.useState(a.attrs.filter(e=>e.tagId==null).map(e=>e.attrId));function R(e){k(e.target.value),a.date=new Date(`${e.target.value} ${N}`)}function z(e){O(e.target.value),a.date=new Date(`${f} ${e.target.value}`)}function G(e){E(e.target.value),a.space=c.find(n=>n.id==e.target.value)}function H(e){V(e.target.value),e.target.value.length==0?a.removeOwnTag():a.setOwnTag(e.target.value)}function J(e){B(e.target.value),a.text=e.target.value}function K(e){F(e.target.checked),a.archived=e.target.checked}function L(e){const n=e.target.value,l=m().find(g=>g.id==n);if(!l)return;const i=v.slice();i.push(l.id),T(i),a.addTag(l)}function m(){return x.filter(e=>!a.tags.find(n=>e.id==n.tagId))}function M(e){return e.spaceId==a.spaceId?e.name:`${c.find(n=>n.id==e.spaceId).name}.${e.name}`}function Q(e){T(v.filter(n=>n!=e.id)),a.removeTag(e)}function p(){return D.filter(e=>!u.find(n=>n==e.id))}function U(e){return e.spaceId==a.spaceId?e.name:`${c.find(n=>n.id==e.spaceId).name}.${e.name}`}function W(){if(m().length!=0)return t("div",{className:"control",children:t("div",{className:"select",children:r("select",{onChange:L,children:[t("option",{value:null},"0"),m().map(e=>t("option",{value:e.id,children:M(e)},e.id))]})})})}function X(){if(a.tags.length!=0)return t("div",{className:"box",children:t("div",{children:a.tags.map(e=>t(te,{noteTag:e,contextSpaceId:a.spaceId,onDelete:()=>Q(e.tag)},e.tag.id))})})}function Y(){if(p().length!=0)return t("div",{className:"control",children:t("div",{className:"select",children:r("select",{onChange:ae,children:[t("option",{value:null},"0"),p().map(e=>t("option",{value:e.id,children:U(e)},e.id))]})})})}function Z(){if(a.attrs.length!=0)return t("div",{className:"box",children:a.attrs.map(e=>t(le,{noteAttr:e,contextSpaceId:a.spaceId,onRemove:()=>ee(e.attr)},e.attrId))})}function ee(e){I(u.filter(n=>n!=e.id)),a.removeAttr(e)}function ae(e){const n=e.target.value,l=p().find(g=>g.id==n);if(!l)return;const i=u.slice();i.push(l.id),I(i),a.addAttr(l)}return t("form",{children:r("fieldset",{children:[r("div",{className:"field",children:[t("label",{className:"label",children:"Space"}),t("div",{className:"control",children:t("div",{className:"select",children:r("select",{value:$,onChange:G,children:[t("option",{value:null},"0"),c.map(e=>t("option",{value:e.id,children:e.name},e.id))]})})})]}),r("div",{className:"field",children:[t("label",{className:"label",children:"Date"}),t("div",{className:"control",children:r("div",{className:"field has-addons",children:[t("p",{className:"control",children:t("input",{type:"date",className:"input",value:f,onChange:R})}),t("p",{className:"control",children:t("input",{type:"time",className:"input",value:N,onChange:z})})]})})]}),r("div",{className:"field",children:[t("label",{className:"label",children:"Own Tag"}),t("div",{className:"control",children:t("input",{type:"text",className:"input",value:q,onChange:H})})]}),r("div",{className:"field",children:[t("label",{className:"label",children:"Text"}),t("div",{className:"control",children:t("textarea",{value:j,className:"textarea",onChange:J})})]}),r("label",{className:"label",children:["Archived",t("input",{type:"checkbox",className:"ml-2",checked:P,onChange:K})]}),r("div",{className:"field",children:[t("label",{className:"label",children:"Tags"}),W()]}),X(),r("div",{className:"field",children:[t("label",{className:"label",children:"Attrs"}),Y()]}),Z(),t("div",{className:"field",children:t("button",{type:"button",onClick:()=>_(a),className:"button is-link",children:"Confirm"})})]})})};try{h.displayName="NoteEditor",h.__docgenInfo={description:"",displayName:"NoteEditor",props:{note:{defaultValue:null,description:"",name:"note",required:!0,type:{name:"Note"}},spaces:{defaultValue:null,description:"",name:"spaces",required:!0,type:{name:"Space[]"}},tags:{defaultValue:null,description:"",name:"tags",required:!0,type:{name:"Tag[]"}},attrs:{defaultValue:null,description:"",name:"attrs",required:!0,type:{name:"Attr[]"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"(note: Note) => Promise<string>"}}}}}catch{}const pe={title:"NoteEditor",component:h,parameters:{layout:"padded"},tags:["autodocs"]},o=new A("Space 1").clean();o.id=1;const y=new A("Space 2").clean();y.id=2;const d={args:{note:new ne("hello").at(new Date(1987,6,5,4,3,2)),spaces:[o,y],tags:(()=>{const a=new re("Test Tag",1).clean();return a.id=1,a.space=o,[a]})(),attrs:(()=>{const a=new se("Test Attr").in(o).clean();return a.id=1,[a]})(),onConfirm:a=>(console.log("Confirm clicked",a),null)}};var S,w,b;d.parameters={...d.parameters,docs:{...(S=d.parameters)==null?void 0:S.docs,source:{originalSource:`{
  args: {
    note: new Note('hello').at(new Date(1987, 6, 5, 4, 3, 2)),
    spaces: [space1, space2],
    tags: (() => {
      const tag1 = new Tag('Test Tag', 1).clean();
      tag1.id = 1;
      tag1.space = space1;
      return [tag1];
    })(),
    attrs: (() => {
      const attr1 = new Attr('Test Attr').in(space1).clean();
      attr1.id = 1;
      return [attr1];
    })(),
    onConfirm: note => {
      console.log('Confirm clicked', note);
      return null;
    }
  }
}`,...(b=(w=d.parameters)==null?void 0:w.docs)==null?void 0:b.source}}};const ge=["Primary"];export{d as Primary,ge as __namedExportsOrder,pe as default};
