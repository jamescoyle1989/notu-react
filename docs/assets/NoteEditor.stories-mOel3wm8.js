import{a,j as r}from"./jsx-runtime-VmuvLVu_.js";import{r as i}from"./index-XiNr8FW2.js";import{N as te}from"./NoteTagBadge-m8jnesCh.js";import{S as x,N as ae,T as ne,A as re}from"./notu-crZ7QRTU.js";import{N as ie}from"./NoteAttrEditor-moSMD9s9.js";import"./_commonjsHelpers-5-cIlDoe.js";const se="_textfield_1f24q_1",ce="_attrFieldsContainer_1f24q_13",w={textfield:se,attrFieldsContainer:ce},m=({note:t,spaces:l,tags:D,attrs:$,onConfirm:k})=>{var S;const[f,q]=i.useState(t.date.toISOString().split("T")[0]),[E,O]=i.useState(t.spaceId),[h,F]=i.useState(t.date.toTimeString().split(" ")[0].substring(0,5)),[V,j]=i.useState(((S=t.ownTag)==null?void 0:S.name)??""),[B,R]=i.useState(t.text),[P,H]=i.useState(t.archived),[v,T]=i.useState(t.tags.map(e=>e.tagId)),[u,N]=i.useState(t.attrs.filter(e=>e.tagId==null).map(e=>e.attrId)),p=i.useRef(null);function z(e){q(e.target.value),t.date=new Date(`${e.target.value} ${h}`)}function G(e){F(e.target.value),t.date=new Date(`${f} ${e.target.value}`)}function J(e){O(e.target.value),t.space=l.find(n=>n.id==e.target.value)}function K(e){j(e.target.value),e.target.value.length==0?t.removeOwnTag():t.setOwnTag(e.target.value)}function L(e){if(R(e.target.value),t.text=e.target.value,p.current){const n=p.current;n.style.height="",n.style.height=n.scrollHeight+"px"}}function M(e){H(e.target.checked),t.archived=e.target.checked}function Q(e){const n=e.target.value,s=I().find(g=>g.id==n);if(!s)return;const c=v.slice();c.push(s.id),T(c),t.addTag(s)}function I(){return D.filter(e=>!t.tags.find(n=>e.id==n.tagId))}function U(e){return e.spaceId==t.spaceId?e.name:`${l.find(n=>n.id==e.spaceId).name}.${e.name}`}function W(e){T(v.filter(n=>n!=e.id)),t.removeTag(e)}function C(){return $.filter(e=>!u.find(n=>n==e.id))}function X(e){return e.spaceId==t.spaceId?e.name:`${l.find(n=>n.id==e.spaceId).name}.${e.name}`}function Y(){if(t.attrs.length!=0)return a("div",{className:w.attrFieldsContainer,children:t.attrs.map(e=>a(ie,{noteAttr:e,contextSpaceId:t.spaceId,onRemove:()=>Z(e.attr)},e.attrId))})}function Z(e){N(u.filter(n=>n!=e.id)),t.removeAttr(e)}function ee(e){const n=e.target.value,s=C().find(g=>g.id==n);if(!s)return;const c=u.slice();c.push(s.id),N(c),t.addAttr(s)}return a("form",{className:"pure-form pure-form-aligned",children:r("fieldset",{children:[r("div",{className:"pure-control-group",children:[a("label",{children:"Space"}),r("select",{value:E,onChange:J,children:[a("option",{value:null},"0"),l.map(e=>a("option",{value:e.id,children:e.name},e.id))]})]}),r("div",{className:"pure-control-group",children:[a("label",{children:"Date"}),a("input",{type:"date",value:f,onChange:z}),a("input",{type:"time",value:h,onChange:G})]}),r("div",{className:"pure-control-group",children:[a("label",{children:"Own Tag"}),a("input",{type:"text",value:V,onChange:K})]}),r("div",{className:"pure-control-group",children:[a("label",{children:"Text"}),a("textarea",{value:B,onChange:L,ref:p,className:w.textfield})]}),r("div",{className:"pure-control-group",children:[a("label",{children:"Archived"}),a("input",{type:"checkbox",checked:P,onChange:M})]}),r("div",{className:"pure-control-group",children:[a("label",{children:"Tags"}),r("select",{onChange:Q,children:[a("option",{value:null},"0"),I().map(e=>a("option",{value:e.id,children:U(e)},e.id))]})]}),a("div",{className:"pure-controls",children:t.tags.map(e=>a(te,{noteTag:e,contextSpaceId:t.spaceId,onDelete:()=>W(e.tag)},e.tag.id))}),r("div",{className:"pure-control-group",children:[a("label",{children:"Attrs"}),r("select",{onChange:ee,children:[a("option",{value:null},"0"),C().map(e=>a("option",{value:e.id,children:X(e)},e.id))]})]}),Y(),a("div",{className:"pure-controls",children:a("button",{type:"button",onClick:()=>k(t),className:"pure-button pure-button-primary",children:"Confirm"})})]})})};try{m.displayName="NoteEditor",m.__docgenInfo={description:"",displayName:"NoteEditor",props:{note:{defaultValue:null,description:"",name:"note",required:!0,type:{name:"Note"}},spaces:{defaultValue:null,description:"",name:"spaces",required:!0,type:{name:"Space[]"}},tags:{defaultValue:null,description:"",name:"tags",required:!0,type:{name:"Tag[]"}},attrs:{defaultValue:null,description:"",name:"attrs",required:!0,type:{name:"Attr[]"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"(note: Note) => string"}}}}}catch{}const me={title:"NoteEditor",component:m,parameters:{layout:"padded"},tags:["autodocs"]},d=new x("Space 1").clean();d.id=1;const b=new x("Space 2").clean();b.id=2;const o={args:{note:new ae("hello").at(new Date(1987,6,5,4,3,2)),spaces:[d,b],tags:(()=>{const t=new ne("Test Tag",1).clean();return t.id=1,t.space=d,[t]})(),attrs:(()=>{const t=new re("Test Attr").in(d).clean();return t.id=1,[t]})(),onConfirm:t=>(console.log("Confirm clicked",t),null)}};var y,A,_;o.parameters={...o.parameters,docs:{...(y=o.parameters)==null?void 0:y.docs,source:{originalSource:`{
  args: {
    note: new Note('hello').at(new Date(1987, 6, 5, 4, 3, 2)),
    spaces: [space1, space2],
    tags: (() => {
      const tag1 = new Tag('Test Tag', 1).clean();
      tag1.id = 1;
      tag1.space = space1;
      return [tag1];
    })(),
    attrs: (() => {
      const attr1 = new Attr('Test Attr').in(space1).clean();
      attr1.id = 1;
      return [attr1];
    })(),
    onConfirm: note => {
      console.log('Confirm clicked', note);
      return null;
    }
  }
}`,...(_=(A=o.parameters)==null?void 0:A.docs)==null?void 0:_.source}}};const fe=["Primary"];export{o as Primary,fe as __namedExportsOrder,me as default};
